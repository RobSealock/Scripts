$filename = "USERS_AD" + "_" + (Get-Date -Format "yyyy-MM-dd") + "_" + (Get-Date -Format "HH-mm") + ".txt"
$pickup = "USERS_AD.txt"
$collect = Get-ADUser -filter * -server %DC_Name_Here% -Properties  enabled,givenName,Surname,SamAccountName,name,employeeID,employeenumber,userPrincipalName,employeeType,mail,city,displayName,company,manager,description,department,pwdLastSet,lastLogon,logonCount,userAccountControl,pwdLastSet,lastLogon,accountExpires,distinguishedName,extensionAttribute1,extensionAttribute2,extensionAttribute3,extensionAttribute4,extensionAttribute5,extensionAttribute6,extensionAttribute7,extensionAttribute8,extensionAttribute9,extensionAttribute10,extensionAttribute11,extensionAttribute12,extensionAttribute13,extensionAttribute14,extensionAttribute15,whenCreated,telephoneNumber,mobile | select enabled,employeeID,employeenumber,sAMAccountName,givenname,surname,name,userPrincipalName,employeeType,mail,city,displayName,company,manager,description,department,@{Name='pwdLastSet';Expression={[DateTime]::FromFileTime($_.pwdLastSet)}},@{Name='LastLogon';Expression={[DateTime]::FromFileTime($_.lastlogon)}},logonCount,userAccountControl,accountExpires,distinguishedName,extensionAttribute1,extensionAttribute2,extensionAttribute3,extensionAttribute4,extensionAttribute5,extensionAttribute6,extensionAttribute7,extensionAttribute8,extensionAttribute9,extensionAttribute10,extensionAttribute11,extensionAttribute12,extensionAttribute13,extensionAttribute14,extensionAttribute15,whenCreated,telephoneNumber,mobile 
$collect | export-csv c:\exports\$filename
